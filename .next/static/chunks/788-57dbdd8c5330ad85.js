(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[788],{1788:(e,t,s)=>{Promise.resolve().then(s.bind(s,2681)),Promise.resolve().then(s.bind(s,9247)),Promise.resolve().then(s.bind(s,5464)),Promise.resolve().then(s.bind(s,7637))},2249:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>l,NM:()=>r});let a=(0,s(5710).Z0)({name:"search",initialState:{searchTerm:"",universities:[],currentPage:1},reducers:{setSearchTerm(e,t){e.searchTerm=t.payload},setUniversities(e,t){e.universities=t.payload},setCurrentPage(e,t){e.currentPage=t.payload}}}),{setSearchTerm:r,setUniversities:n,setCurrentPage:i}=a.actions,l=a.reducer},5464:(e,t,s)=>{"use strict";s.d(t,{default:()=>v});var a=s(5155),r=s(2115),n=s(5695),i=s(4540),l=s(2249);s(8839);let c=()=>{let e=(0,i.wA)(),t=(0,i.d4)(e=>e.search.searchTerm),[s,n]=(0,r.useState)(t);return(0,a.jsxs)("div",{className:"search",children:[(0,a.jsx)("div",{className:"search__input",children:(0,a.jsx)("input",{type:"text",value:s,onChange:e=>{n(e.target.value)},placeholder:"Enter your request...",className:"search-input"})}),(0,a.jsx)("div",{className:"search__button",children:(0,a.jsxs)("button",{className:"button",onClick:()=>{let t=s.toLowerCase().trim();localStorage.setItem("searchTerm",t),e((0,l.NM)(t)),window.dispatchEvent(new Event("searchTermUpdated"))},children:["Search ",(0,a.jsx)("i",{className:"bi bi-search"})]})})]})};var o=s(6758),d=s(7652);let h=e=>{let{universities:t,id:s,handleCloseDetailsPage:r}=e,i=(0,d.c3)();if(!t||0===t.length||!s)return(0,a.jsx)("p",{children:"No university data available"});let l=t.find(e=>e.domains.includes(s));return l||(0,n.notFound)(),(0,a.jsxs)("div",{className:"details-container",children:[(0,a.jsxs)("button",{onClick:r,className:"close-details",children:[(0,a.jsx)("i",{className:"bi bi-x-lg"})," ",i("detailsPage.close")]}),(0,a.jsx)("h2",{children:l.name}),(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[i("detailsPage.country"),":"]})," ",l.country]}),(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[i("detailsPage.domains"),":"]})," ",l.domains.join(", ")]}),(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[i("detailsPage.webSite"),":"]})," ",(0,a.jsx)("a",{href:l.web_pages[0],target:"_blank",rel:"noreferrer",children:l.web_pages[0]})]})]})};s(7473);var u=s(7637),m=s(6766);async function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",s=arguments.length>2?arguments[2]:void 0,a={method:t,headers:{Accept:"application/json"}};s&&["POST","PUT","PATCH"].includes(t)&&(a.body=JSON.stringify(s));try{let t=await fetch("".concat("https://react-app-danilovaasya.netlify.app/api").concat(e),a);if(!t.ok){let e=await t.text();throw console.error("API request failed: ".concat(t.status," - ").concat(e)),Error("API request failed: ".concat(t.status," - ").concat(e))}return await t.json()}catch(t){throw console.error("Error API request ".concat(e,":"),t),t}}async function p(){try{return await g("/search?&offset=1&limit=9")}catch(e){throw console.error("Error fetching universities",e),e}}async function x(e){try{return await g("/search?&country=".concat(e))}catch(t){throw console.log("Error fetching universities for ".concat(e,":"),t),t}}let j=e=>{let{currentPage:t,showDetails:s}=e,c=(0,d.c3)(),[g,j]=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",[s,a]=(0,r.useState)(()=>{try{let s=localStorage.getItem(e);return null!=s?s:t}catch(e){return console.error(e),t}});return[s,t=>{try{a(t),localStorage.setItem(e,t)}catch(e){console.error(e)}}]}("searchTerm",""),v=(0,n.useRouter)(),f=(0,i.wA)(),b=(0,n.useParams)(),y="string"==typeof(null==b?void 0:b.id)?b.id:void 0,[w,N]=(0,r.useState)(!0),[S,P]=(0,r.useState)(null),k=(0,i.d4)(e=>e.selectedItems.items),[C,T]=(0,r.useState)(0),[E,A]=(0,r.useState)([]),[I,_]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{N(!0);try{let e;e=g.trim()?await x(g.trim()):await p(),A(e),P(null)}catch(e){P(e instanceof Error?e.message:"Unknown error")}finally{N(!1)}})()},[C,g]),(0,r.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("searchTerm")||"";j(e),f((0,l.NM)(e)),T(e=>e+1)};return window.addEventListener("searchTermUpdated",e),()=>window.removeEventListener("searchTermUpdated",e)},[f,j]);let M=b&&"string"==typeof b.locale?b.locale:"en",L=E.slice((t-1)*u.M5,t*u.M5),U=async e=>{try{let t=await fetch("/api/generate-csv",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:e})});if(!t.ok)throw Error("Failed to generate CSV");let s=await t.blob(),a=(t.headers.get("Content-Disposition")||"").match(/filename="(.+)"/),r=a?a[1]:"download.csv",n=URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download=r,document.body.appendChild(i),i.click(),i.remove(),setTimeout(()=>URL.revokeObjectURL(n),100)}catch(e){console.error("Error downloading CSV:",e),alert("Failed to download CSV. Please try again!")}};return w||I?(0,a.jsx)("div",{className:"loader-container",children:(0,a.jsx)("p",{className:"loader-message",children:c("results.loading",{defaultValue:"Loading universities, please wait..."})})}):(0,a.jsxs)("div",{className:"results-container",children:[(0,a.jsx)("button",{className:"refresh-button",onClick:()=>{_(!0),setTimeout(()=>_(!1),1e3),T(e=>e+1)},style:{marginLeft:"1rem"},children:(0,a.jsx)("i",{className:"bi bi-arrow-clockwise"})}),(0,a.jsxs)("div",{className:"before-pagination",children:[(0,a.jsx)("div",{className:"master-container",children:S?(0,a.jsx)("p",{className:"error-message",children:String(S)}):Array.isArray(L)&&0!==L.length?L.map(e=>{let s=k.some(t=>t.domains[0]===e.domains[0]);return(0,a.jsxs)("div",{className:"university-card",style:{cursor:"pointer"},onClick:s=>{!s.target.closest(".select-checkbox")&&v.push("/".concat(M,"/").concat(t,"/").concat(e.domains[0]))},children:[(0,a.jsx)("input",{type:"checkbox",className:"select-checkbox",checked:s,onClick:e=>e.stopPropagation(),onChange:t=>{t.target.checked?f((0,o.mL)(e)):f((0,o.lG)(e.domains[0]))}}),(0,a.jsx)("h3",{children:e.name}),(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[c("detailsPage.country"),":"]})," ",e.country]}),(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:[c("detailsPage.webSite"),":"]})," ",(0,a.jsx)("a",{href:e.web_pages[0],target:"_blank",rel:"noreferrer",children:e.web_pages[0]||c("detailsPage.noWebSite")})]})]},e.domains[0])}):(0,a.jsxs)("div",{className:"error-container",children:[(0,a.jsx)(m.default,{src:"/no-data.png",alt:"No data",width:128,height:128}),(0,a.jsx)("p",{className:"error-message",children:c("results.noData",{defaultValue:"No universities available to display."})})]})}),y&&s&&E.length>0&&(0,a.jsx)("div",{className:"details-panel",children:(0,a.jsx)(h,{universities:E,id:y,handleCloseDetailsPage:()=>{v.push("/".concat(M,"/").concat(t))}})})]}),(0,a.jsxs)("div",{className:"pagination-container",children:[(0,a.jsx)("button",{className:"previous-button",onClick:()=>{t>1&&v.push("/".concat(M,"/").concat(t-1))},disabled:1===t,children:c("results.previous")}),(0,a.jsxs)("span",{className:"pagination-info",children:[t||0," ",c("results.page")," ",c("results.of")," ",Math.ceil(E.length/u.M5)]}),(0,a.jsx)("button",{className:"next-button",onClick:()=>{t<Math.ceil(E.length/u.M5)&&v.push("/".concat(M,"/").concat(t+1))},disabled:t>=Math.ceil(E.length/u.M5),children:c("results.next")})]}),k.length>0&&(0,a.jsxs)("div",{className:"flyout",children:[(0,a.jsxs)("span",{children:[k.length," ",c("results.selectedItems")]}),(0,a.jsx)("button",{onClick:()=>f((0,o.JS)()),children:c("results.unselectAll")}),(0,a.jsx)("button",{onClick:()=>U(k),children:c("results.downloadCsv")})]})]})};s(7727);let v=()=>{let e=(0,d.c3)(),t=(0,n.useParams)(),s=parseInt((null==t?void 0:t.page)||"1",10),o=!!(null==t?void 0:t.id),h=(0,i.wA)(),u=(0,i.d4)(e=>e.search.searchTerm);return((0,r.useEffect)(()=>{if(!u){let e=localStorage.getItem("searchTerm")||"";h((0,l.NM)(e))}},[h,u]),isNaN(s)||s<1)?(0,n.notFound)():(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"main-container",children:[(0,a.jsx)("p",{className:"app-description",children:e("mainPage.description")}),(0,a.jsx)(m.default,{src:"/graduation.png",alt:"graduation",width:700,height:250})]}),(0,a.jsx)(c,{}),(0,a.jsx)(j,{currentPage:s,showDetails:o})]})}},6758:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>l,JS:()=>i,lG:()=>n,mL:()=>r});let a=(0,s(5710).Z0)({name:"selectedItems",initialState:{items:[]},reducers:{selectItem(e,t){e.items.push(t.payload)},unselectItem(e,t){e.items=e.items.filter(e=>e.domains[0]!==t.payload)},unselectAll(e){e.items=[]}}}),{selectItem:r,unselectItem:n,unselectAll:i}=a.actions,l=a.reducer},7473:()=>{},7727:()=>{},8839:()=>{}}]);